---
title: "An exploration of dingo observations in the ALA"
description: |
  Time-series analyses can be handy for seeing trends over time, and exploring how trends relate to major events. Here, we show how to create an exploratory time-series plot comparing observations of waterbirds prior to and during the COVID-19 pandemic.
author:
  - name: "Amos Smith"
  - name: "Dax Kellie"
date: "2023-04-04"
title-block-banner: "#B8573E"
include-after-body: _footer.html
toc: true
toc-location: left
toc-depth: 2
categories:
  - Eukaryota
  - Animalia
  - Mammalia
  - Summaries
  - Maps
  - Intern-post
image: ducks.png
freeze: true
draft: true
editor_options: 
  chunk_output_type: console
---

```{r}
#| include: false
library(htmltools)
```

<!-- remove metadata section -->
```{css, echo = FALSE}
#title-block-header.quarto-title-block.default .quarto-title-meta {
    display: none;
}
```


<!-- Author card -->

:::{.author-card}
:::{.author-card-text}

#### Author
Amos Smith 
[Olivia Torresan](https://labs.ala.org.au/people/Torresan_Olivia/index.html)  
[Dax Kellie](https://labs.ala.org.au/people/Kellie_Dax/index.html)  

#### Date
4 April 2023

:::

:::{.author-card-image}
```{r, out.width='120px', out.extra='style="clip-path: circle();"', echo=FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/AtlasOfLivingAustralia/ala-labs/main/images/people/amos.jpg")
```
:::

:::{.author-card-image}
```{r, out.width='120px', out.extra='style="clip-path: circle();"', echo=FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/AtlasOfLivingAustralia/ala-labs/main/images/people/olivia.jpg")
```
:::

:::{.author-card-image}
```{r, out.width='120px', out.extra='style="clip-path: circle();"', echo=FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/AtlasOfLivingAustralia/ala-labs/main/images/people/dax.jpg")
```
:::

:::

<!------------------------ Post starts here ------------------------>

:::{.callout-tip}

## Intern Post

:::

The dingo is among Australia's most recognised species internationally. However, debate continues on whether dingoes are considered pests or protected native species.

Dingoes have had major negative impacts on livestock producers, especially sheep farmers. To reduce this impact, landowners and government spend an estimated [\~$30 million annually across Australia](https://www.publish.csiro.au/wr/pdf/WR19030) to control wild dog and dingo populations. Populations are often controlled using traps, baits and shooting. Australia also constructed the Dingo Fence, a wire fence made to protect from the loss of sheep for the sheep industry; it is the longest fence in the world (5,614 km). 

Since its construction 80 years ago, the Dingo Fence has shaped the landscape of Australia. Perhaps unintentionally, [the dingo fence has acted as a natural experiment that has shown the importance of apex predators like dingoes in ecosystems](https://www.abc.net.au/news/2023-02-09/dingo-fence-map-ecology-farming-predator-sheep-extinction/101711608). On the side where dingoes remain present there is [more vegetation](https://link.springer.com/article/10.1007/s10980-021-01206-w) and [fewer invasive species like foxes](https://www.publish.csiro.au/am/AM21036) than on the side where dingoes are absent, benefiting native biodiversity. The difference between sides of the fence is so distinct that [you can even see it from space](https://youtu.be/ivmQk5EsScw)!

Historical and current control programs along with habitat loss have impacted dingo populations negatively, despite evidence that [dingoes can be allies for livestock producers](https://theconversation.com/killing-dingoes-is-the-only-way-to-protect-livestock-right-nope-200905). Dingoes are currently listed as [vulnerable to extinction under the IUNC's Red List of Threatened Species](https://www.iucnredlist.org/species/41585/10484199). 

In an exploratory analysis, here we'll use data in the Atlas of Living Australia (ALA) to investigate how historical and ongoing differences in attitudes towards dingo conservation affect where and how often dingo observations are recorded.



# Summarise observations

Let's start by finding how many observations of dingoes are in the ALA and where they are.

::: {layout-ncol="3" style="margin-left: auto; margin-right: auto;"}
<img src="https://ala-images.s3.ap-southeast-2.amazonaws.com/store/5/5/b/b/19578b8d-f8a3-4ae8-a139-60f9d4d6bb55/original" class="rounded"/></img>

<img src="https://ala-images.s3.ap-southeast-2.amazonaws.com/store/c/8/a/5/2716b0eb-0d0f-41cd-9c33-d517f45e5a8c/original" class="rounded"/></img>

<img src="https://ala-images.s3.ap-southeast-2.amazonaws.com/store/3/2/4/a/5f426a63-4b4f-4def-b6ed-14316b40a423/original" class="rounded"/></img>
:::

::: figure-caption
Left: [*Canis familiaris* (Michael Hains CC-BY-NC 3.0 (Au)](https://biocache.ala.org.au/occurrences/4d4a1b5d-f70f-4286-9282-3c325cdf2646), Middle: [*Canis familiaris* (GibberGavin CC-BY-NC 4.0 (Int))](https://biocache.ala.org.au/occurrences/24b77a44-2a8d-4d16-a4e3-41823d1fc8ca), Right: [*Canis familiaris* (Danial Moore CC-BY-NC 3.0 (Au))](https://biocache.ala.org.au/occurrences/64cc4167-9f4f-495c-b4be-b0a5e2ca57de)
:::


```{r}
#| warning: false
#| message: false

# packages
library(galah)
library(tidyverse)
library(ozmaps)
library(sf)
library(patchwork)
library(here)
library(rmapshaper)
library(ggpointdensity)
library(glue)
library(ggtext)
```

### Find fields to filter data

We'll use the [{galah} package](http://galah.ala.org.au/) to download our data. Because **Canis familiaris** is the taxonomic name of both dingoes *and* dogs, if we only search using the scientific name, we'll likely return more than just dingo records. To fix this, let's filter our records to those specified by the data provider with the name common name "Dingo". 

:::{.aside}
One can imagine that sometimes data might be collected without specifying the name "Dingo" (either due to uncertainty or a lack of specificity in the survey). If true, there might be observations of dingoes that we'll never know because they weren't specified (though it's hard to know for sure)!
:::

Let's use `search_fields()` to help us find which fields we can use to filter the taxonomic name. There are a few options, but the `raw_vernacularName` field seems to hold original common names specified by data providers.

```{r}
#| message: false
search_fields("common name")
search_fields("raw_vernacularName") |> search_values("dingo")
```

We can use the same method to find a field that contains states & territories.

```{r}
#| message: false
search_fields("australian states")
search_fields("cl22") |> show_values()
```


### State observations

We'll download the number of dingo observations in each state/territory with `atlas_counts()` and arrange the resulting counts in descending order. 

Around 75% of dingo observations are recorded in the Northern Territory and South Australia.

```{r}
dingo_counts <- galah_call() |>
  galah_identify("canis familiaris") |>
  galah_filter(raw_vernacularName == c("Dingo", "dingo")) |>
  galah_group_by(cl22) |>
  # galah_apply_profile(ALA) |> # set of data quality filters
  atlas_counts() |>
  arrange(desc(count))
```

```{r}
#| echo: false
dingo_counts 
```

```{r}
#| code-fold: true
#| message: false
#| warning: false
# Add map of australia
aus <- ozmap_data(data = "states")

# Join state counts to our map
state_counts <- aus %>%
  full_join(dingo_counts, by = c("NAME" = "cl22"))

# log-transform data to scale counts for nicer plotting
logged_counts <- state_counts |>
  mutate(log = log10(count))|>
  replace_na(list(log = 0))

# plot
ggplot() +
  geom_sf(data = logged_counts,
          mapping = aes(fill = log)) +
  geom_sf_text(data = logged_counts,
               aes(label = count),
               colour = "white",
               size = 8,
               fun.geometry = sf::st_centroid) +
  scale_fill_distiller(palette = "OrRd", direction = 1) +
  labs(x = "Longitude", y = "Latitude") +
  theme_void() + 
  theme(legend.position = "none")
```


### Data providers

Next let's find out who the main data providers are of dingo observations to see whether observations come from citizen science programs or state monitoring programs. We'll filter to only display providers that have provided more than 5 observations of dingoes.

```{r}
data_providers <- galah_call() |>
  galah_identify("canis familiaris") |>
  galah_filter(raw_vernacularName == c("Dingo", "dingo")) |>
  galah_group_by(dataResourceName)|>
  galah_apply_profile(ALA) |>
  atlas_counts()

counts_filtered <- data_providers |>
  filter(count > 5)
```

```{r}
#| echo: false
counts_filtered
```


We can also check to see where each data provider's observations are recorded. We'll download dingo observations using `atlas_occurrences()`. Then we'll filter our observations to only those supplied by providers in `counts_filtered`.

You will need to first provide a [registered email with the ALA](https://auth.ala.org.au/userdetails/registration/createAccount) using `galah_config()` before retrieving records.

```{r}
#| echo: false

# Use a ALA-registered email (register at ala.org.au)
galah_config(email = "SMI9E9@csiro.au", verbose = FALSE)
```

```{r, echo = FALSE}
#| eval: false

# Use a ALA-registered email (register at ala.org.au)
galah_config(email = "your-email-here")
```

```{r}
dingo_obs <- galah_call()|>
  galah_identify("canis familiaris") |>
  galah_filter(raw_vernacularName == c("Dingo", "dingo")) |>
  galah_apply_profile(ALA) |>
  atlas_occurrences()
```

```{r}
#| echo: false
dingo_obs
```

```{r}
points_filtered <- dingo_obs |>
  filter(dataResourceName %in% counts_filtered$dataResourceName)
```

```{r}
#| echo: false
points_filtered
```


We'll create a bar plot and a map of observations to visualise where dingoes are seen and who records them. 

Just five data providers account for ~98% of dingo records, with Fauna Atlas N. T. contributing ~40% of records. All major data providers are government monitoring programs, rather than citizen science providers like iNaturalist. 

```{r}
#| code-fold: true
#| column: page
#| fig-align: center
#| layout-nrow: 1
#| message: false
#| warning: false

counts_filtered %>%
  ggplot(aes(x = reorder(str_wrap(dataResourceName, 28), count), 
             y = count, fill = dataResourceName)) +
    geom_bar(stat="identity", width=.8) +
    scale_fill_manual(values = c(
    "Museums Victoria provider for OZCAM" = "#604830", 
    "Victorian Biodiversity Atlas" = "#486030", 
    "Australian National Wildlife Collection provider for OZCAM" = "#6090d8", 
    "NSW BioNet Atlas" = "#604830", 
    "WildNet - Queensland Wildlife Data" = "#6fab3f",
    "SA Fauna (BDBSA)" = "#d89060", 
    "Australian Museum provider for OZCAM" = "#FFC300", 
    "Fauna Atlas N.T." = "#a84830")) +
  scale_x_discrete(expand = c(0,0)) +
  scale_y_continuous(labels = scales::label_comma()) +
    coord_flip() +
    xlab("") +
    pilot::theme_pilot(grid = "v",
                       axes = "b") + 
  theme(legend.position = "none",
        axis.text = element_text(size = 12))

# bar_plot

ggplot() +
  geom_sf(data = aus, fill = "#FBFBEF") +
  geom_point(data = points_filtered,
             mapping = aes(x = decimalLongitude,
                           y = decimalLatitude,
                           colour = dataResourceName),
             alpha = 0.25) +
  scale_color_manual(values = c(
    "Museums Victoria provider for OZCAM" = "#604830", 
    "Victorian Biodiversity Atlas" = "#486030", 
    "Australian National Wildlife Collection provider for OZCAM" = "#6090d8",
    "NSW BioNet Atlas" = "#604830", 
    "WildNet - Queensland Wildlife Data" = "#6fab3f",
    "SA Fauna (BDBSA)" = "#d89060", 
    "Australian Museum provider for OZCAM" = "#FFC300", 
    "Fauna Atlas N.T." = "#a84830")) +
  theme_void() +
  coord_sf(ylim = c(-45, -10), 
           xlim = c(110, 155)) +
  theme(legend.position = "none")

# # Plot bar plot and map
# bar_plot + data_providers + 
#   plot_annotation(
#     title = "Data Providers of Dingo Observations"
#   ) + 
#   plot_layout(widths = c(1, 3),
#               heights = c(2, 1))
```

Government monitoring programs provide regular and reliable data. However, [incidental observations from citizen scientists can fill gaps in species distribution data](https://ecoevorxiv.org/repository/view/3650/). 

It's also possible that differences between states/territories attitudes towards dingoes and their conservation status between states/territories affect the amount of data recorded of dingo observations. For example, the Northern Territory is the only state in Australia that recognizes dingoes as a protected species. Other states like Western Australia, New South Wales, Queensland and South Australia consider dingoes outside the Dog Fence an unprotected native animal and inside the Dingo Fence a pest species under the National Parks and Wildlife Act 1972. These differences in legislation between states might help to explain why the highest numbers of observations are in areas that recognize dingoes as protected.






<details><summary style = "color: #E06E53;">Expand for session info</summary>

```{r, echo = FALSE}
library(sessioninfo)
# save the session info as an object
pkg_sesh <- session_info(pkgs = "attached")
# print it out
pkg_sesh
```

</details>
